!function(){"use strict";var e="";const t={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__submit-btn",inactiveButtonClass:"modal__submit-btn_inactive",inputErrorClass:"modal__input_type_error",errorClass:"modal__input-error_active"},o=(e,t,o)=>{r(e)?n(t):(t.disabled=!1,t.classList.remove(o.inactiveButtonClass))},n=e=>{e.disabled=!0,e.classList.add(t.inactiveButtonClass)},r=e=>e.some((e=>!e.validity.valid));var c=e+"2fc47fd8e9a9bcd9612f.jpg",a=e+"5c2584faa41177b41691.svg",s=e+"40608da7369d39bc1077.svg",l=e+"d3610e9c6dce3cb370d8.svg";document.getElementById("image-avatar").src=c,document.getElementById("image-pencil").src=a,document.getElementById("image-plus").src=s,document.getElementById("image-logo").src=l;const i=document.querySelector("#preview-modal"),d=i.querySelector(".modal__image--preview"),m=i.querySelector(".modal__caption--preview"),u=i.querySelector(".modal__close-btn--preview"),p=document.querySelector(".cards__list");function _(e){const t=document.querySelector("#card__template").content.querySelector(".card").cloneNode(!0),o=t.querySelector(".card__title"),n=t.querySelector(".card__image");o.textContent=e.name,n.src=e.link,n.alt=e.name,n.addEventListener("click",(()=>{d.src=e.link,d.alt=e.name,m.textContent=e.name,B(i)}));const r=t.querySelector(".card__like-btn");return r.addEventListener("click",(()=>{r.classList.toggle("card__like-btn_liked")})),t.querySelector(".card__delete-btn").addEventListener("click",(e=>{t.remove()})),t}u.addEventListener("click",(()=>{z(i)})),[{name:"Val Thorens",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/spots/1-photo-by-moritz-feldmann-from-pexels.jpg"},{name:"Restaurant terrace",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/spots/2-photo-by-ceiline-from-pexels.jpg"},{name:"An outdoor cafe",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/spots/3-photo-by-tubanur-dogan-from-pexels.jpg"},{name:"A very long bridge, over the forest and through the trees",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/spots/4-photo-by-maurice-laschet-from-pexels.jpg"},{name:"Tunnel with morning light",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/spots/5-photo-by-van-anh-nguyen-from-pexels.jpg"},{name:"Mountain house",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/spots/6-photo-by-moritz-feldmann-from-pexels.jpg"}].forEach((e=>{const t=_(e);p.append(t)}));const y=document.querySelector("#profile-edit-modal"),v=document.querySelector(".profile__edit-btn"),f=document.querySelector(".modal__close-btn--edit-profile"),g=(document.querySelector(".modal__submit-btn--edit-profile"),document.querySelector(".modal__form--edit-profile")),S=g.querySelector("#name"),b=g.querySelector("#description"),q=document.querySelector(".profile__name"),w=document.querySelector(".profile__description"),h=document.querySelector("#new-post-modal"),k=document.querySelector(".profile__add-btn"),E=document.querySelector(".modal__close-btn--new-post"),L=(document.querySelector(".modal__submit-btn--new-post"),document.querySelector(".modal__form--new-post")),C=L.querySelector("#image-link"),x=L.querySelector("#post-caption");function B(e){e.classList.add("modal_opened"),document.addEventListener("keydown",j)}function z(e){e.classList.remove("modal_opened"),document.removeEventListener("keydown",j)}function j(e){console.log("escape is clicked"),"Escape"===e.key&&z(document.querySelector(".modal_opened"))}v.addEventListener("click",(()=>{B(y),S.value=q.textContent,b.value=w.textContent})),k.addEventListener("click",(()=>{B(h)})),f.addEventListener("click",(()=>{z(y)})),E.addEventListener("click",(()=>{z(h)})),g.addEventListener("submit",(function(e){e.preventDefault();const t=S.value,o=b.value;q.textContent=t,w.textContent=o,z(y)})),L.addEventListener("submit",(function(e){e.preventDefault();const t=_({name:x.value,link:C.value});p.prepend(t),x.value="",C.value="",z(h)})),document.querySelectorAll(".modal").forEach((e=>{e.addEventListener("click",(t=>{t.target===e&&z(e)}))})),(e=>{Array.from(document.querySelectorAll(e.formSelector)).forEach((t=>{((e,t)=>{const n=Array.from(e.querySelectorAll(t.inputSelector)),r=e.querySelector(t.submitButtonSelector);o(n,r,t),n.forEach((c=>{c.addEventListener("input",(function(){((e,t,o)=>{t.validity.valid?((e,t,o)=>{const n=e.querySelector(`.${t.id}-error`);t.classList.remove(o.inputErrorClass),n.classList.remove(o.errorClass),n.textContent=""})(e,t,o):((e,t,o,n)=>{const r=e.querySelector(`.${t.id}-error`);t.classList.add(n.inputErrorClass),r.textContent=o,r.classList.add(n.errorClass)})(e,t,t.validationMessage,o)})(e,c,t),o(n,r,t)}))}))})(t,e)}))})(t)}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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R0FDdkMsRUMrS0o4RixDQUFpQjlGLEUiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zZV9wcm9qZWN0X3Nwb3RzL3dlYnBhY2svYm9vdHN0cmFwIiwid2VicGFjazovL3NlX3Byb2plY3Rfc3BvdHMvd2VicGFjay9ydW50aW1lL3B1YmxpY1BhdGgiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9zcG90cy8uL3NyYy9zY3JpcHRzL3ZhbGlkYXRpb24uanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9zcG90cy8uL3NyYy9wYWdlcy9pbmRleC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBUaGUgcmVxdWlyZSBzY29wZVxudmFyIF9fd2VicGFja19yZXF1aXJlX18gPSB7fTtcblxuIiwiX193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjsiLCJjb25zdCBzZXR0aW5ncyA9IHtcbiAgICBmb3JtU2VsZWN0b3I6IFwiLm1vZGFsX19mb3JtXCIsXG4gICAgaW5wdXRTZWxlY3RvcjogXCIubW9kYWxfX2lucHV0XCIsXG4gICAgc3VibWl0QnV0dG9uU2VsZWN0b3I6IFwiLm1vZGFsX19zdWJtaXQtYnRuXCIsXG4gICAgaW5hY3RpdmVCdXR0b25DbGFzczogXCJtb2RhbF9fc3VibWl0LWJ0bl9pbmFjdGl2ZVwiLFxuICAgIGlucHV0RXJyb3JDbGFzczogXCJtb2RhbF9faW5wdXRfdHlwZV9lcnJvclwiLFxuICAgIGVycm9yQ2xhc3M6IFwibW9kYWxfX2lucHV0LWVycm9yX2FjdGl2ZVwiXG4gIH1cblxuXG5cbmNvbnN0IHRvZ2dsZUJ1dHRvblN0YXRlID0gKGlucHV0TGlzdCwgYnV0dG9uRWxlbWVudCxzZXR0aW5ncykgPT4ge1xuICAgICAgICBpZihoYXNJbnZhbGlkSW5wdXQoaW5wdXRMaXN0KSl7XG4gICAgICAgICAgIGRpc2FibGVCdXR0b24oYnV0dG9uRWxlbWVudCk7XG4gICAgICAgICAgIFxuICAgICAgICB9XG4gICAgICAgIGVsc2V7XG4gICAgICAgICAgICBidXR0b25FbGVtZW50LmRpc2FibGVkID0gZmFsc2U7XG4gICAgICAgICAgICBidXR0b25FbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoc2V0dGluZ3MuaW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gICAgICAgIH1cbiB9O1xuXG4gY29uc3QgZGlzYWJsZUJ1dHRvbiA9IChidXR0b25FbGVtZW50KSA9PiB7XG4gIGJ1dHRvbkVsZW1lbnQuZGlzYWJsZWQgPSB0cnVlO1xuICBidXR0b25FbGVtZW50LmNsYXNzTGlzdC5hZGQoc2V0dGluZ3MuaW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gfTtcblxuIGNvbnN0IGhhc0ludmFsaWRJbnB1dCA9IChpbnB1dExpc3QpID0+IHtcbiAgICByZXR1cm4gaW5wdXRMaXN0LnNvbWUoKGlucHV0RWxlbWVudCkgPT4ge1xuICAgICAgcmV0dXJuICFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQ7XG4gICAgfSk7XG4gIH07XG5cbmNvbnN0IHNob3dJbnB1dEVycm9yID0gKGZvcm1FbGVtZW50LCBpbnB1dEVsZW1lbnQsIGVycm9yTWVzc2FnZSwgc2V0dGluZ3MpID0+IHtcbiAgICBjb25zdCBlcnJvckVsZW1lbnQgPSBmb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKGAuJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYCk7XG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5hZGQoc2V0dGluZ3MuaW5wdXRFcnJvckNsYXNzKTtcbiAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBlcnJvck1lc3NhZ2U7XG4gICAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5hZGQoc2V0dGluZ3MuZXJyb3JDbGFzcyk7XG4gICBcbiAgfTtcblxuY29uc3QgaGlkZUlucHV0RXJyb3IgPSAoZm9ybUVsZW1lbnQsIGlucHV0RWxlbWVudCwgc2V0dGluZ3MpID0+IHtcbiAgICBjb25zdCBlcnJvckVsZW1lbnQgPSBmb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKGAuJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYCk7XG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoc2V0dGluZ3MuaW5wdXRFcnJvckNsYXNzKTtcbiAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShzZXR0aW5ncy5lcnJvckNsYXNzKTtcbiAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBcIlwiO1xuICB9O1xuXG5cbmNvbnN0IGNoZWNrSW5wdXRWYWxpZGl0eSA9IChmb3JtRWxlbWVudCwgaW5wdXRFbGVtZW50LHNldHRpbmdzKSA9PiB7XG4gICAgaWYoIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZCkge1xuICAgICAgICBzaG93SW5wdXRFcnJvcihmb3JtRWxlbWVudCwgIGlucHV0RWxlbWVudCwgaW5wdXRFbGVtZW50LnZhbGlkYXRpb25NZXNzYWdlLCBzZXR0aW5ncyk7XG5cbiAgICB9XG4gICAgZWxzZXtcbiAgICAgICAgaGlkZUlucHV0RXJyb3IoZm9ybUVsZW1lbnQsIGlucHV0RWxlbWVudCxzZXR0aW5ncyk7XG4gICAgfVxufTtcblxuXG5jb25zdCBzZXRFdmVudExpc3RlbmVycyA9IChmb3JtRWxlbWVudCxzZXR0aW5ncykgPT57XG4gIGNvbnN0IGlucHV0TGlzdCA9IEFycmF5LmZyb20oZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbChzZXR0aW5ncy5pbnB1dFNlbGVjdG9yKSk7XG4gIGNvbnN0IGJ1dHRvbkVsZW1lbnQgPSBmb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKHNldHRpbmdzLnN1Ym1pdEJ1dHRvblNlbGVjdG9yKTtcbiAgdG9nZ2xlQnV0dG9uU3RhdGUoaW5wdXRMaXN0LCBidXR0b25FbGVtZW50LCBzZXR0aW5ncyk7XG4gIGlucHV0TGlzdC5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcbiAgICBpbnB1dEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsIGZ1bmN0aW9uKCl7XG4gICAgICAgIGNoZWNrSW5wdXRWYWxpZGl0eShmb3JtRWxlbWVudCwgaW5wdXRFbGVtZW50LHNldHRpbmdzKTtcbiAgICAgICAgdG9nZ2xlQnV0dG9uU3RhdGUoaW5wdXRMaXN0LCBidXR0b25FbGVtZW50LHNldHRpbmdzKTtcbiAgICB9KTtcbiAgfSk7XG59O1xuXG5cbmNvbnN0IGVuYWJsZVZhbGlkYXRpb24gPSAoc2V0dGluZ3MpID0+IHtcbiAgY29uc3QgZm9ybUxpc3QgPSBBcnJheS5mcm9tKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoc2V0dGluZ3MuZm9ybVNlbGVjdG9yKSk7XG4gIGZvcm1MaXN0LmZvckVhY2goKGZvcm1FbGVtZW50KSA9PntcbiAgICBzZXRFdmVudExpc3RlbmVycyhmb3JtRWxlbWVudCxzZXR0aW5ncyk7XG4gIH0pO1xufTtcblxuLy8gZW5hYmxlVmFsaWRhdGlvbihzZXR0aW5ncyk7XG5cblxuY29uc3QgcmVzZXRGb3JtVmFsaWRhdGlvbiA9IChmb3JtRWxlbWVudCxzZXR0aW5ncykgPT4ge1xuICAgIGNvbnN0IGlucHV0TGlzdCA9IEFycmF5LmZyb20oZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbChzZXR0aW5ncy5pbnB1dFNlbGVjdG9yKSk7XG4gICAgY29uc3QgYnV0dG9uRWxlbWVudCA9IGZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3Ioc2V0dGluZ3Muc3VibWl0QnV0dG9uU2VsZWN0b3IpO1xuICBcbiAgICBpbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XG4gICAgICBoaWRlSW5wdXRFcnJvcihmb3JtRWxlbWVudCwgaW5wdXRFbGVtZW50LCBzZXR0aW5ncyk7XG4gICAgfSk7XG4gIFxuICAgIHRvZ2dsZUJ1dHRvblN0YXRlKGlucHV0TGlzdCwgYnV0dG9uRWxlbWVudCwgc2V0dGluZ3MpO1xuICB9O1xuXG4gIGV4cG9ydCB7IGVuYWJsZVZhbGlkYXRpb24sIHNldHRpbmdzIH07IFxuIiwiaW1wb3J0IFwiLi9pbmRleC5jc3NcIjtcbmltcG9ydCB7IGVuYWJsZVZhbGlkYXRpb24sIHNldHRpbmdzfSBmcm9tIFwiLi4vc2NyaXB0cy92YWxpZGF0aW9uLmpzXCI7XG5cbmltcG9ydCBhdmF0YXJTcmMgZnJvbSBcIi4uL2ltYWdlcy9hdmF0YXIuanBnXCI7XG5jb25zdCBhdmF0YXJJbWFnZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiaW1hZ2UtYXZhdGFyXCIpO1xuYXZhdGFySW1hZ2Uuc3JjID0gYXZhdGFyU3JjO1xuaW1wb3J0IHBlbmNpbFNyYyBmcm9tIFwiLi4vaW1hZ2VzL3BlbmNpbC5zdmdcIjtcbmNvbnN0IHBlbmNpbEltYWdlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJpbWFnZS1wZW5jaWxcIik7XG5wZW5jaWxJbWFnZS5zcmMgPSBwZW5jaWxTcmM7XG5pbXBvcnQgcGx1c1NyYyBmcm9tIFwiLi4vaW1hZ2VzL3BsdXMuc3ZnXCI7XG5jb25zdCBwbHVzaW1hZ2UgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImltYWdlLXBsdXNcIik7XG5wbHVzaW1hZ2Uuc3JjID0gcGx1c1NyYztcbmltcG9ydCBsb2dvU3JjIGZyb20gXCIuLi9pbWFnZXMvbG9nby5zdmdcIjtcbmNvbnN0IGxvZ29JbWFnZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiaW1hZ2UtbG9nb1wiKTtcbmxvZ29JbWFnZS5zcmMgPSBsb2dvU3JjO1xuXG5jb25zdCBpbml0aWFsQ2FyZHMgPSBbXG4gIHtcbiAgICBuYW1lOiBcIlZhbCBUaG9yZW5zXCIsXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL3Nwb3RzLzEtcGhvdG8tYnktbW9yaXR6LWZlbGRtYW5uLWZyb20tcGV4ZWxzLmpwZ1wiLFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJSZXN0YXVyYW50IHRlcnJhY2VcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvc3BvdHMvMi1waG90by1ieS1jZWlsaW5lLWZyb20tcGV4ZWxzLmpwZ1wiLFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJBbiBvdXRkb29yIGNhZmVcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvc3BvdHMvMy1waG90by1ieS10dWJhbnVyLWRvZ2FuLWZyb20tcGV4ZWxzLmpwZ1wiLFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJBIHZlcnkgbG9uZyBicmlkZ2UsIG92ZXIgdGhlIGZvcmVzdCBhbmQgdGhyb3VnaCB0aGUgdHJlZXNcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvc3BvdHMvNC1waG90by1ieS1tYXVyaWNlLWxhc2NoZXQtZnJvbS1wZXhlbHMuanBnXCIsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIlR1bm5lbCB3aXRoIG1vcm5pbmcgbGlnaHRcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvc3BvdHMvNS1waG90by1ieS12YW4tYW5oLW5ndXllbi1mcm9tLXBleGVscy5qcGdcIixcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiTW91bnRhaW4gaG91c2VcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvc3BvdHMvNi1waG90by1ieS1tb3JpdHotZmVsZG1hbm4tZnJvbS1wZXhlbHMuanBnXCIsXG4gIH0sIFxuXTtcblxuIC8vRGVjbGFyZSBhIHZhcmlhYmxlIGZvciB0aGUgcHJldmlldyBtb2RhbFxuIGNvbnN0IHByZXZpZXdNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJldmlldy1tb2RhbFwiKTtcbiAvL0RlY2xhcmUgYSB2YXJpYWJsZSBmb3IgdGhlIHByZWl2ZXcgbW9kYWwgaW1hZ2VcbiBjb25zdCBwcmV2aWV3SW1hZ2UgPSBwcmV2aWV3TW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9faW1hZ2UtLXByZXZpZXdcIik7XG5cbiAvL0RlbGNhcmUgYSB2YXJpYWJsZSBmb3IgdGhlIHByZXZpZXcgbW9kYWwgY2FwdGlvblxuIGNvbnN0IHByZXZpZXdDYXB0aW9uID0gcHJldmlld01vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2NhcHRpb24tLXByZXZpZXdcIik7XG5cbiAvL0RlY2xhcmUgYSB2YXJpYWJsZSBmb3IgdGhlIHByZXZpZXcgY2xvc2UgYnV0dG9uXG4gY29uc3QgcHJldmlld0Nsb3NlQnRuID0gcHJldmlld01vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Nsb3NlLWJ0bi0tcHJldmlld1wiKTtcblxuXG4vL0dlbmVyYXRpbmcgQ2FyZHNcblxuY29uc3QgY2FyZHNMaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkc19fbGlzdFwiKTtcblxuZnVuY3Rpb24gZ2V0Q2FyZEVsZW1lbnQoZGF0YSkge1xuICAvL0RlY2xhcmUgYW5kIGNob29zZSB0aGUgdGVtcGxhdGUgdGhhdCB3YXMgbWFkZSBmb3IgdGhlIGNhcmRzIGFuZCBtYWUgaXQgY2FyZFRlbXBsYXRlXG4gIGNvbnN0IGNhcmRUZW1wbGF0ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjY2FyZF9fdGVtcGxhdGVcIikuY29udGVudDtcblxuICAvL0RlY2xhcmUgdGhlIGFjdHVhbCBjYXJkIGVsZW1lbnQgdGhhdCB3ZSB3YW50IHRvIGFkZCB0byB0aGUgRE9NXG4gIGNvbnN0IGNhcmRFbGVtZW50ID0gY2FyZFRlbXBsYXRlLnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZFwiKS5jbG9uZU5vZGUodHJ1ZSk7XG5cbiAgLy9EZWNsYXJlIGEgdmFyaWFibGUgZm9yIHRoZSBjYXJkIHRpdGxlXG4gIGNvbnN0IGNhcmRUaXRsZSA9IGNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fdGl0bGVcIik7XG5cbiAgLy9EZWNsYXJlIGEgdmFydWFiZSBmb3IgdGhlIGNhcmQgSW1hZ2VcbiAgY29uc3QgY2FyZEltYWdlID0gY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19pbWFnZVwiKTtcblxuICAvL1BvcHVsYXRlIHRoZSBlbGVtZW50IHdpdGggdGhlIGN1cnJlbnQgZGF0YSBmcm9tIHRoZSBsaXN0XG4gIGNhcmRUaXRsZS50ZXh0Q29udGVudCA9IGRhdGEubmFtZTtcbiAgY2FyZEltYWdlLnNyYyA9IGRhdGEubGluaztcbiAgY2FyZEltYWdlLmFsdCA9IGRhdGEubmFtZTtcblxuICAvL09wZW4gdGhlIHByZXZpZXcgbW9kYWwgd2hlbiB0aGUgaW1hZ2UgaXMgY2xpY2tlZFxuICBjYXJkSW1hZ2UuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAvL0Fzc2lnbiBpdHMgc3JjIHZhbHVlIHRvIHRoZSBjdXJyZW50IGNhcmRzIHNyYyB2YWx1ZVxuICAgIHByZXZpZXdJbWFnZS5zcmMgPSBkYXRhLmxpbms7XG4gICAgcHJldmlld0ltYWdlLmFsdCA9IGRhdGEubmFtZTtcbiAgICBwcmV2aWV3Q2FwdGlvbi50ZXh0Q29udGVudCA9IGRhdGEubmFtZTtcblxuICAgIG9wZW5Nb2RhbChwcmV2aWV3TW9kYWwpO1xuICB9KTtcblxuXG4gIC8vIERlY2xhcmUgYSB2YXJpYWJsZSBmb3IgdGhlIGNhcmQgbGlrZSBidXR0b25cbiAgY29uc3QgY2FyZExpa2VCdG4gPSBjYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xpa2UtYnRuXCIpO1xuXG4gIC8vIExpc3RlbiBmb3IgYSBjbGljayBldmVudCB0byBjaGFuZ2UgdGhlIGNvbG9yIG9mIHRoZSBidXR0b25cbiAgY2FyZExpa2VCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICBjYXJkTGlrZUJ0bi5jbGFzc0xpc3QudG9nZ2xlKFwiY2FyZF9fbGlrZS1idG5fbGlrZWRcIik7XG4gIH0pO1xuXG4gIC8vIERlY2xhcmUgYSB2YXJpYWJsZSBmb3IgdGhlIGNhcmQgZGVsZXRlIGJ1dHRvblxuICBjb25zdCBjYXJkRGVsZXRlQnRuID0gY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19kZWxldGUtYnRuXCIpO1xuICAvL0xpc3RlbiBmb3IgYSBjbGljayBldmVudCB0byBkZWxldGUgdGhlIGNhcmRcbiAgY2FyZERlbGV0ZUJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGV2ZW50KSA9PiB7XG4gICAgY2FyZEVsZW1lbnQucmVtb3ZlKCk7XG4gIH0pO1xuXG4gIHJldHVybiBjYXJkRWxlbWVudDtcbn1cblxuICAvL0Nsb3NlIHRoZSBwcmV2aWV3IG1vZGFsIHdoZW4gdGhlIGNsb3NlIGJ1dHRvbiBpcyBjbGlja2VkXG4gIHByZXZpZXdDbG9zZUJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgIGNsb3NlTW9kYWwocHJldmlld01vZGFsKTtcbiAgfSk7XG5cbi8vIHVzZSBmb3JlYWNoIG1ldGhvZCB0byBpbml0YWxpemUgdGhlIGNhcmRzXG4vLyB0aGlzIHdheSB3ZSBkb24ndCBoYXZlIHRvIHdvcnJ5IGFib3V0IHRoZSBsZW5ndGggb2YgdGhlIGluaXRhbCBjYXJkIGFycmF5XG4vLyBhbHNvIHRoZSBjb2RlIGlzIG1vcmUgY29uY2lzZVxuaW5pdGlhbENhcmRzLmZvckVhY2goKGl0ZW0pID0+IHtcbiAgY29uc3QgY2FyZCA9IGdldENhcmRFbGVtZW50KGl0ZW0pO1xuICBjYXJkc0xpc3QuYXBwZW5kKGNhcmQpO1xufSk7XG5cbi8vVGhlIEVkaXQgUHJvZmlsZSBNb2RhbFxuXG5jb25zdCBwcm9maWxlTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtZWRpdC1tb2RhbFwiKTtcbmNvbnN0IGVkaXRQcm9maWxlQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19lZGl0LWJ0blwiKTtcbmNvbnN0IGNsb3NlUHJvZmlsZUJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Nsb3NlLWJ0bi0tZWRpdC1wcm9maWxlXCIpO1xuY29uc3Qgc3VibWl0UHJvZmlsZUJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX3N1Ym1pdC1idG4tLWVkaXQtcHJvZmlsZVwiKTtcblxuY29uc3QgcHJvZmlsZUZvcm1FbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybS0tZWRpdC1wcm9maWxlXCIpO1xuY29uc3QgbmFtZUlucHV0ID0gcHJvZmlsZUZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjbmFtZVwiKTtcbmNvbnN0IGpvYklucHV0ID0gcHJvZmlsZUZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjZGVzY3JpcHRpb25cIik7XG5jb25zdCBwcm9maWxlTmFtZUVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX25hbWVcIik7XG5jb25zdCBwcm9maWxlSm9iRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fZGVzY3JpcHRpb25cIik7XG5cbi8vIFRoZSBOZXcgUG9zdCBNb2RhbFxuXG5jb25zdCBuZXdQb3N0TW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI25ldy1wb3N0LW1vZGFsXCIpO1xuY29uc3QgbmV3UG9zdEJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYWRkLWJ0blwiKTtcbmNvbnN0IG5ld1Bvc3RDbG9zZUJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Nsb3NlLWJ0bi0tbmV3LXBvc3RcIik7XG5jb25zdCBuZXdQb3N0U3VibWl0QnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fc3VibWl0LWJ0bi0tbmV3LXBvc3RcIik7XG5cbmNvbnN0IG5ld1Bvc3RGb3JtRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm0tLW5ldy1wb3N0XCIpO1xuY29uc3QgaW1hZ2VMaW5rSW5wdXQgPSBuZXdQb3N0Rm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcIiNpbWFnZS1saW5rXCIpO1xuY29uc3QgY2FwdGlvbklucHV0ID0gbmV3UG9zdEZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcG9zdC1jYXB0aW9uXCIpO1xuXG4vLyoqKiBPcGVuaW5nIHRoZSBtb2RhbHMgKioqXG5cbi8vVGhpcyBmdW5jdGlvbiB3aWxsIG9wZW4gYW55IG1vZGFsIHRoYXQncyBwYXNzZWQgb250byBpdFxuZnVuY3Rpb24gb3Blbk1vZGFsKG1vZGFsKSB7XG4gIG1vZGFsLmNsYXNzTGlzdC5hZGQoXCJtb2RhbF9vcGVuZWRcIik7XG4gIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCBoYW5kbGVFc2NhcGUpO1xuXG59XG5cbi8vQ2FsbCB0aGUgb3Blbk1vZGFsIGZ1bmN0aW9uIG9uIHRoZSBlZGl0IHByb2ZpbGUgYnV0dG9uIGNsaWNrXG5lZGl0UHJvZmlsZUJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBvcGVuTW9kYWwocHJvZmlsZU1vZGFsKTtcbiAgLy9JbnNlcnQgdGhlIGN1cnJlbnQgcHJvZmlsZSBuYW1lIHZhbHVlIGludG8gdGhlIGZvcm0ncyBpbnB1dCBmaWVsZFxuICBuYW1lSW5wdXQudmFsdWUgPSBwcm9maWxlTmFtZUVsZW1lbnQudGV4dENvbnRlbnQ7XG4gIC8vSW5zZXJ0IHRoZSBjdXJyZW50IHByb2ZpbGUgam9iIHZhbHVlIGludG8gdGhlIGZvcm0ncyBpbnB1dCBmaWVsZFxuICBqb2JJbnB1dC52YWx1ZSA9IHByb2ZpbGVKb2JFbGVtZW50LnRleHRDb250ZW50O1xufSk7XG5cbi8vQ2FsbCB0aGUgb3Blbk1vZGFsIGZ1bmN0aW9uIG9uIHRoZSBuZXcgcG9zdCBidXR0b24gY2xpY2tcbm5ld1Bvc3RCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgb3Blbk1vZGFsKG5ld1Bvc3RNb2RhbCk7XG59KTtcblxuLy8qKiogQ2xvc2luZyB0aGUgbW9kYWxzICoqKlxuXG4vL1RoaXMgZnVuY3Rpb24gd2lsbCBjbG9zZSBhbnkgbW9kYWwgdGhhdCdzIHBhc3NlZCBvbnRvIGl0XG5mdW5jdGlvbiBjbG9zZU1vZGFsKG1vZGFsKSB7XG4gIG1vZGFsLmNsYXNzTGlzdC5yZW1vdmUoXCJtb2RhbF9vcGVuZWRcIik7XG4gIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCBoYW5kbGVFc2NhcGUpO1xufVxuXG4vL0NhbGwgdGhlIGNsb3NlTW9kYWwgZnVuY3Rpb24gb24gdGhlIGVkaXQgcHJvZmlsZSBjbG9zZSBidXR0b24gY2xpY2tcbmNsb3NlUHJvZmlsZUJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBjbG9zZU1vZGFsKHByb2ZpbGVNb2RhbCk7XG59KTtcblxuLy9DYWxsIHRoZSBjbG9zZU1vZGFsIGZ1bmN0aW9uIG9uIHRoZSBjbG9zZSBuZXcgcG9zdCBidXR0b24gY2xpY2tcbm5ld1Bvc3RDbG9zZUJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBjbG9zZU1vZGFsKG5ld1Bvc3RNb2RhbCk7XG59KTtcblxuXG5cbi8vKioqIFN1Ym1pdHRpbmcgdGhlIHByb2ZpbGUgY2hhbmdlcyAqKipcblxuLy8gVGhlICBwcm9maWxlIGZvcm0gc3VibWlzc2lvbiBoYW5kbGVyLlxuZnVuY3Rpb24gaGFuZGxlUHJvZmlsZUZvcm1TdWJtaXQoZXZ0KSB7XG4gIC8vIFByZXZlbnQgZGVmYXVsdCBicm93c2VyIGJlaGF2aW9yXG4gIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gIC8vIEdldCB0aGUgdmFsdWVzIG9mIGVhY2ggZm9ybSBmaWVsZCBmcm9tIHRoZSB2YWx1ZSBwcm9wZXJ0eVxuICAvLyBvZiB0aGUgY29ycmVzcG9uZGluZyBpbnB1dCBlbGVtZW50LlxuICBjb25zdCBuYW1lSW5wdXRWYWx1ZSA9IG5hbWVJbnB1dC52YWx1ZTtcbiAgY29uc3Qgam9iSW5wdXRWYWx1ZSA9IGpvYklucHV0LnZhbHVlO1xuICAvL1RoZW4gaW5zZXJ0IHRoZXNlIG5ldyB2YWx1ZXMgaW50byB0aGUgdGV4dENvbnRlbnQgcHJvcGVydHkgb2YgdGhlXG4gIC8vIGNvcnJlc3BvbmRpbmcgcHJvZmlsZSBlbGVtZW50cy5cbiAgcHJvZmlsZU5hbWVFbGVtZW50LnRleHRDb250ZW50ID0gbmFtZUlucHV0VmFsdWU7XG4gIHByb2ZpbGVKb2JFbGVtZW50LnRleHRDb250ZW50ID0gam9iSW5wdXRWYWx1ZTtcbiAgLy8gVE9ETzogQ2xvc2UgdGhlIG1vZGFsLlxuICBjbG9zZU1vZGFsKHByb2ZpbGVNb2RhbCk7XG59XG5cbi8vIENvbm5lY3QgdGhlIGhhbmRsZXIgdG8gdGhlIGZvcm0sIHNvIGl0IHdpbGwgd2F0Y2ggZm9yIHRoZSBzdWJtaXQgZXZlbnQuXG5wcm9maWxlRm9ybUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCBoYW5kbGVQcm9maWxlRm9ybVN1Ym1pdCk7XG5cbi8vKioqIFN1Ym1pdHRpbmcgdGhlIG5ldyBwb3N0IHBob3RvcyBhbmQgY2FwdGlvbnMgKioqXG5cbmZ1bmN0aW9uIGhhbmRsZU5ld1Bvc3RTdWJtaXQoZXZ0KSB7XG4gIC8vIFByZXZlbnQgZGVmYXVsdCBicm93c2VyIGJlaGF2aW9yXG4gIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gIC8vQ3JlYXR3IGEgbmV3IHBvc3Qgd2l0aCB1c2VyIGRhdGFcbiAgY29uc3QgbmV3UG9zdCA9IHsgbmFtZTogY2FwdGlvbklucHV0LnZhbHVlLCBsaW5rOiBpbWFnZUxpbmtJbnB1dC52YWx1ZSB9O1xuICAvLyBHZW5lcmF0ZSB0aGUgY2FyZCBmb3IgdGhlIG5ldyBwb3N0XG4gIGNvbnN0IG5ld0NhcmQgPSBnZXRDYXJkRWxlbWVudChuZXdQb3N0KTtcbiAgLy9BZGQgdGhlIG5ldyBjYXJkIHRvIHRoZSBjYXJkcyBsaXN0XG4gIGNhcmRzTGlzdC5wcmVwZW5kKG5ld0NhcmQpO1xuICAvL0Nsb3NlIHRoZSBtb2RhbFxuICBjYXB0aW9uSW5wdXQudmFsdWUgPSBcIlwiO1xuICBpbWFnZUxpbmtJbnB1dC52YWx1ZSA9IFwiXCI7XG4gIGNsb3NlTW9kYWwobmV3UG9zdE1vZGFsKTtcbn1cblxuLy8gQ29ubmVjdCB0aGUgaGFuZGxlciB0byB0aGUgZm9ybSwgc28gaXQgd2lsbCB3YXRjaCBmb3IgdGhlIHN1Ym1pdCBldmVudC5cbm5ld1Bvc3RGb3JtRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIGhhbmRsZU5ld1Bvc3RTdWJtaXQpO1xuXG5cbi8vQ2FsbCB0aGUgY2xvc2VNb2RhbGZ1bmN0aW9uIHdoZW4gdGhlIG92ZXJsYXkgaXMgY2xpY2tlZFxuY29uc3QgbW9kYWxzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5tb2RhbFwiKTtcbm1vZGFscy5mb3JFYWNoKChtb2RhbCkgPT4ge1xuICBtb2RhbC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGV2ZW50KSA9PiB7XG4gICAgaWYgKGV2ZW50LnRhcmdldCA9PT0gbW9kYWwpIHtcbiAgICAgIGNsb3NlTW9kYWwobW9kYWwpO1xuICAgIH1cbiAgfSk7XG59KTtcblxuXG5cbi8vQ2FsbCB0aGUgY2xvc2VNb2RhbGZ1bmN0aW9uIHdoZW4gdGhlIEVTQyBLZXkgaXMgY2xpY2tlZFxuXG5mdW5jdGlvbiBoYW5kbGVFc2NhcGUoZXZ0KSB7XG4gIGNvbnNvbGUubG9nKCdlc2NhcGUgaXMgY2xpY2tlZCcpO1xuICBpZiAoZXZ0LmtleSA9PT0gJ0VzY2FwZScpIHtcbiAgICBjb25zdCBvcGVuZWRNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF9vcGVuZWQnKTtcbiAgICBjbG9zZU1vZGFsKG9wZW5lZE1vZGFsKTtcbiAgfVxufVxuXG5lbmFibGVWYWxpZGF0aW9uKHNldHRpbmdzKTsiXSwibmFtZXMiOlsiX193ZWJwYWNrX3JlcXVpcmVfXyIsInNldHRpbmdzIiwiZm9ybVNlbGVjdG9yIiwiaW5wdXRTZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsImlucHV0RXJyb3JDbGFzcyIsImVycm9yQ2xhc3MiLCJ0b2dnbGVCdXR0b25TdGF0ZSIsImlucHV0TGlzdCIsImJ1dHRvbkVsZW1lbnQiLCJoYXNJbnZhbGlkSW5wdXQiLCJkaXNhYmxlQnV0dG9uIiwiZGlzYWJsZWQiLCJjbGFzc0xpc3QiLCJyZW1vdmUiLCJhZGQiLCJzb21lIiwiaW5wdXRFbGVtZW50IiwidmFsaWRpdHkiLCJ2YWxpZCIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJzcmMiLCJhdmF0YXJTcmMiLCJwZW5jaWxTcmMiLCJwbHVzU3JjIiwibG9nb1NyYyIsInByZXZpZXdNb2RhbCIsInF1ZXJ5U2VsZWN0b3IiLCJwcmV2aWV3SW1hZ2UiLCJwcmV2aWV3Q2FwdGlvbiIsInByZXZpZXdDbG9zZUJ0biIsImNhcmRzTGlzdCIsImdldENhcmRFbGVtZW50IiwiZGF0YSIsImNhcmRFbGVtZW50IiwiY29udGVudCIsImNsb25lTm9kZSIsImNhcmRUaXRsZSIsImNhcmRJbWFnZSIsInRleHRDb250ZW50IiwibmFtZSIsImxpbmsiLCJhbHQiLCJhZGRFdmVudExpc3RlbmVyIiwib3Blbk1vZGFsIiwiY2FyZExpa2VCdG4iLCJ0b2dnbGUiLCJldmVudCIsImNsb3NlTW9kYWwiLCJmb3JFYWNoIiwiaXRlbSIsImNhcmQiLCJhcHBlbmQiLCJwcm9maWxlTW9kYWwiLCJlZGl0UHJvZmlsZUJ0biIsImNsb3NlUHJvZmlsZUJ0biIsInByb2ZpbGVGb3JtRWxlbWVudCIsIm5hbWVJbnB1dCIsImpvYklucHV0IiwicHJvZmlsZU5hbWVFbGVtZW50IiwicHJvZmlsZUpvYkVsZW1lbnQiLCJuZXdQb3N0TW9kYWwiLCJuZXdQb3N0QnRuIiwibmV3UG9zdENsb3NlQnRuIiwibmV3UG9zdEZvcm1FbGVtZW50IiwiaW1hZ2VMaW5rSW5wdXQiLCJjYXB0aW9uSW5wdXQiLCJtb2RhbCIsImhhbmRsZUVzY2FwZSIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJldnQiLCJjb25zb2xlIiwibG9nIiwia2V5IiwidmFsdWUiLCJwcmV2ZW50RGVmYXVsdCIsIm5hbWVJbnB1dFZhbHVlIiwiam9iSW5wdXRWYWx1ZSIsIm5ld0NhcmQiLCJwcmVwZW5kIiwicXVlcnlTZWxlY3RvckFsbCIsInRhcmdldCIsIkFycmF5IiwiZnJvbSIsImZvcm1FbGVtZW50Iiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJjaGVja0lucHV0VmFsaWRpdHkiLCJoaWRlSW5wdXRFcnJvciIsImVycm9yRWxlbWVudCIsImlkIiwic2hvd0lucHV0RXJyb3IiLCJlcnJvck1lc3NhZ2UiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsImVuYWJsZVZhbGlkYXRpb24iXSwic291cmNlUm9vdCI6IiJ9